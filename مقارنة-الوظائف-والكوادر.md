# مقارنة متطلبات الوظائف والخدمات المهنية (V3 – Jobs & Services) مع تنفيذ خدمة كوادر

> **المرجع:** Full Handover Documents for bThwani Super App & Web Development  
> **التاريخ:** فبراير 2025  
> **الغرض:** شرح ما هو مطلوب في خدمة الوظائف والكوادر (V3) وفق وثيقة التسليم، وما تم تنفيذه فعلياً في المشروع (خدمة كوادر)

---

## الفهرس

1. [نظرة عامة](#1-نظرة-عامة)
2. [المقارنة حسب الباك اند](#2-المقارنة-حسب-الباك-اند)
3. [المقارنة حسب لوحة التحكم](#3-المقارنة-حسب-لوحة-التحكم)
4. [المقارنة حسب التطبيق (app-user)](#4-المقارنة-حسب-التطبيق-app-user)
5. [المقارنة حسب الويب (bthwani-web)](#5-المقارنة-حسب-الويب-bthwani-web)
6. [ملخص تنفيذ الميزات](#6-ملخص-تنفيذ-الميزات)

---

## 1. نظرة عامة

### 1.1 متطلبات الوظائف والخدمات (V3 – Jobs & Services)

وفق مستند التسليم، الخدمة تتضمن:

| المتطلبات                            | الوصف                                                                         |
| ------------------------------------ | ----------------------------------------------------------------------------- |
| **نشر وظيفة / عرض خدمة**             | إنشاء إعلان وظيفة أو عرض خدمة (عنوان، وصف، نوع، راتب/ميزانية، موقع)           |
| **ملف المستقل (Freelancer Profile)** | صفحة عامة: عروض المستقل، معرض أعماله، التقييمات، نبذة                         |
| **التقديم على الوظيفة**              | زر "تقدم الآن" + طلب تقديم (cover note) + حالة (قيد المراجعة / مقبول / مرفوض) |
| **معرض الأعمال (Portfolio)**         | رفع وسائط (صور/فيديو) مع وصف لعرض أعمال مقدم الخدمة                           |
| **التقييمات والمراجعات**             | تقييم (نجوم) + تعليق بعد إتمام الخدمة؛ متوسط تقييم للملف العام                |
| **المحادثة**                         | تواصل بين صاحب العرض ومقدم الطلب (بدء محادثة من تفاصيل العرض)                 |
| **تقويم الحجوزات (اختياري)**         | Slots وربط بحجوزات الخدمات — مرحلة لاحقة                                      |

### 1.2 الخدمات الأساسية المطلوبة (معمارية الباك اند)

| الخدمة                       | الوصف                             | الحالة في المشروع                                   |
| ---------------------------- | --------------------------------- | --------------------------------------------------- |
| **job-posting-service**      | إنشاء/تعديل إعلانات الوظائف       | ✅ مدمج في `KawaderService` + كيان `Kawader`        |
| **service-offer-service**    | عروض الخدمات للمستقلين/الشركات    | ✅ نفس الكيان مع تمييز `offerType`: job / service   |
| **portfolio-service**        | رفع وسائط ومعرض المستخدم          | ✅ `KawaderPortfolio` + `KawaderMedia` + رفع صورة   |
| **application-service**      | التقديم على الوظيفة + بدء محادثة  | ✅ `KawaderApplication` + POST apply + kawader-chat |
| **review-service**           | تتبع الخدمات المكتملة + التقييمات | ✅ `KawaderReview` + متوسط تقييم + قائمة مراجعات    |
| **booking-calendar-service** | إدارة المواعيد/الـ slots          | ❌ غير منفذ (مرحلة لاحقة)                           |

### 1.3 الميزات حسب المستند (Core / Advanced / Smart)

| النوع        | الميزات المطلوبة                                                                              | ما لدينا                                                                                            |
| ------------ | --------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------- |
| **Core**     | نشر وظيفة/عرض خدمة، ملف المستقل، تقييمات الخدمة، زر تقدم الآن، اختيار الدور عند التسجيل       | ✅ نشر، تقييمات، تقدم الآن؛ ملف المستقل جزئي (عرض عروض المعلن + معرضه + تقييماته داخل تفاصيل العرض) |
| **Advanced** | تقويم الحجوزات، تفعيل التوفر، معرض Portfolio، فئات (خدمات منزلية، مستقل، احترافي)             | ✅ معرض Portfolio؛ ❌ تقويم حجوزات؛ الفئات عبر نطاق العمل (WORK_SCOPES)                             |
| **Smart**    | اقتراح السيرة (AI)، اقتراح تطابق الوظائف، تنبيهات تلقائية للمهارات/الخدمات، شارة "مستقل قريب" | ❌ غير منفذ                                                                                         |

---

## 2. المقارنة حسب الباك اند

### 2.1 جدول المقارنة التفصيلي

| الميزة                      | المتطلب (V3)                                           | الموضع في الباك اند                                                                                                                | الحالة      |
| --------------------------- | ------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------- | ----------- |
| **نشر عرض وظيفة/خدمة**      | إنشاء إعلان بعنوان، وصف، نوع، راتب، موقع               | `POST /kawader` — CreateKawaderDto (offerType, jobType, location, salary, scope, budget, metadata)                                 | ✅ منفذ     |
| **قائمة العروض**            | GET مع فلاتر وبحث                                      | `GET /kawader` — cursor، offerType، jobType، location                                                                              | ✅ منفذ     |
| **عروضي (بلاغاتي)**         | قائمة عروض المستخدم الحالي                             | `GET /kawader/my` — مصادقة، ownerId = userId                                                                                       | ✅ منفذ     |
| **بحث نصي**                 | بحث في المهارات، العنوان، الوصف، فلترة راتب/نوع/موقع   | `GET /kawader/search?q=...&status=...&offerType=...&jobType=...&location=...&budgetMin/Max`                                        | ✅ منفذ     |
| **تفاصيل عرض**              | GET عرض واحد                                           | `GET /kawader/:id`                                                                                                                 | ✅ منفذ     |
| **تحديث/حذف عرض**           | للمالك فقط                                             | `PATCH /kawader/:id`، `DELETE /kawader/:id` — تحقق ownerId                                                                         | ✅ منفذ     |
| **التقديم على العرض**       | POST تقديم + cover note                                | `POST /kawader/:id/apply` — body: { coverNote? }                                                                                   | ✅ منفذ     |
| **قائمة التقديمات على عرض** | للمالك فقط                                             | `GET /kawader/:id/applications` — populate user                                                                                    | ✅ منفذ     |
| **تقديماتي**                | قائمة تقديمات المستخدم الحالي                          | `GET /kawader/applications/my` — cursor، limit                                                                                     | ✅ منفذ     |
| **تحديث حالة التقديم**      | قبول/رفض (للمالك)                                      | `PATCH /kawader/applications/:appId/status` — body: { status }                                                                     | ✅ منفذ     |
| **معرض الأعمال**            | رفع وسائط + وصف، معرضي، معرض مستخدم                    | `POST /kawader/portfolio`، `GET /kawader/portfolio/me`، `GET /kawader/portfolio/user/:userId`، `DELETE /kawader/portfolio/:itemId` | ✅ منفذ     |
| **رفع صورة للمعرض**         | للحصول على mediaId                                     | `POST /kawader/portfolio/upload` — ملف صورة، يرجع { id }                                                                           | ✅ منفذ     |
| **التقييمات**               | إنشاء مراجعة (rating، comment)، مراجعات مستخدم + متوسط | `POST /kawader/:id/review`، `GET /kawader/reviews/user/:userId` (items + averageRating + reviewCount)                              | ✅ منفذ     |
| **تقويم الحجوزات**          | Slots وإدارة المواعيد                                  | —                                                                                                                                  | ❌ غير منفذ |

### 2.2 نقاط الـ API المنفذة

| Endpoint                              | الطريقة | الوصف                                                                |
| ------------------------------------- | ------- | -------------------------------------------------------------------- |
| `/kawader`                            | POST    | إنشاء عرض (وظيفة أو خدمة)                                            |
| `/kawader`                            | GET     | قائمة عروض (فلاتر: cursor، offerType، jobType، location)             |
| `/kawader/my`                         | GET     | عروضي (مصادقة)                                                       |
| `/kawader/search`                     | GET     | بحث (q، status، offerType، jobType، location، budgetMin/Max، cursor) |
| `/kawader/:id`                        | GET     | تفاصيل عرض                                                           |
| `/kawader/:id`                        | PATCH   | تحديث عرض (للمالك)                                                   |
| `/kawader/:id`                        | DELETE  | حذف عرض (للمالك)                                                     |
| `/kawader/:id/apply`                  | POST    | تقديم على العرض (coverNote اختياري)                                  |
| `/kawader/:id/applications`           | GET     | قائمة التقديمات (للمالك فقط)                                         |
| `/kawader/applications/my`            | GET     | تقديماتي                                                             |
| `/kawader/applications/:appId/status` | PATCH   | تحديث حالة تقديم (للمالك: accepted \| rejected)                      |
| `/kawader/portfolio/upload`           | POST    | رفع صورة لمعرض الأعمال (يرجع id)                                     |
| `/kawader/portfolio`                  | POST    | إضافة عنصر معرض (mediaIds، caption)                                  |
| `/kawader/portfolio/me`               | GET     | معرضي                                                                |
| `/kawader/portfolio/user/:userId`     | GET     | معرض مستخدم (عام)                                                    |
| `/kawader/portfolio/:itemId`          | DELETE  | حذف عنصر معرض (للمالك)                                               |
| `/kawader/:id/review`                 | POST    | إنشاء مراجعة (rating، comment)                                       |
| `/kawader/reviews/user/:userId`       | GET     | مراجعات مستخدم (للملف العام) + متوسط وعدد                            |

### 2.3 الجداول/الـ Entities المنفذة

| Entity               | الوصف                                                                                                                                     |
| -------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |
| `Kawader`            | عرض وظيفة/خدمة: عنوان، وصف، نطاق، ميزانية، offerType، jobType، location، salary، metadata (مهارات، خبرة، تواصل، عن بُعد)، status، ownerId |
| `KawaderApplication` | تقديم: kawaderId، userId، coverNote، status (pending / accepted / rejected)                                                               |
| `KawaderPortfolio`   | عنصر معرض: userId، mediaIds (مراجع لـ KawaderMedia)، caption                                                                              |
| `KawaderMedia`       | وسيط معرض: url، userId (لرفع الصور وعرض الرابط)                                                                                           |
| `KawaderReview`      | مراجعة: kawaderId، reviewerId، revieweeId، rating (1–5)، comment                                                                          |

مقارنة مع جداول المستند:

| جدول في المستند  | الحالة في المشروع                              |
| ---------------- | ---------------------------------------------- |
| job_posts        | ✅ مدمج في `Kawader` (عند offerType = job)     |
| service_offers   | ✅ مدمج في `Kawader` (عند offerType = service) |
| job_applications | ✅ `KawaderApplication`                        |
| portfolios       | ✅ `KawaderPortfolio` + `KawaderMedia`         |

---

## 3. المقارنة حسب لوحة التحكم (admin-dashboard)

| الميزة                    | المتطلب                                 | التنفيذ                                          | الحالة                                                   |
| ------------------------- | --------------------------------------- | ------------------------------------------------ | -------------------------------------------------------- |
| **قائمة عروض الكوادر**    | عرض عروض مع فلاتر                       | `KawaderListPage` / إدارة كوادر — بحث، فلترة     | ✅ موجود (قابل توسيع فلاتر offerType، jobType، location) |
| **تفاصيل عرض**            | عرض كامل بيانات العرض                   | صفحة تفاصيل مع إمكانية تحديث الحالة              | ✅ موجود                                                 |
| **عرض التقديمات على عرض** | قائمة التقديمات (قراءة أو إجراء للأدمن) | مذكور في الخطة (المرحلة 8) — قائمة تقديمات للعرض | ⚠️ قد يكون جزئي أو مخطط                                  |
| **إحصائيات**              | نظرة عامة على الكوادر                   | `GET /admin/kawader/stats/overview`              | ✅ موجود                                                 |

حسب خطة الإكمال (المرحلة 8): إضافة فلاتر offerType و jobType في القائمة، عمود النوع والموقع في الجدول، وعرض التقديمات في صفحة التفاصيل.

---

## 4. المقارنة حسب التطبيق (app-user)

| الميزة           | المتطلب                                                          | التنفيذ                                                                            | الحالة  |
| ---------------- | ---------------------------------------------------------------- | ---------------------------------------------------------------------------------- | ------- |
| **قائمة العروض** | تصفح، فلاتر، بحث                                                 | `KawaderListScreen` — تبويبات (الكل / عروضي / تقدماتي / معرضي)، بحث، تحميل المزيد  | ✅ منفذ |
| **تفاصيل عرض**   | عرض كامل، نوع العرض، موقع، راتب، تواصل، تقدم الآن                | `KawaderDetailsScreen` — تفاصيل، زر تقدم الآن، للمالك عرض التقديمات وقبول/رفض      | ✅ منفذ |
| **إنشاء عرض**    | عنوان، وصف، نوع عرض، نوع وظيفة، موقع، راتب/ميزانية، نطاق، مهارات | `KawaderCreateScreen` — offerType، jobType، location، salary، scope، metadata      | ✅ منفذ |
| **تعديل عرض**    | تحديث كل الحقول                                                  | `KawaderEditScreen` — نفس الحقول                                                   | ✅ منفذ |
| **تقدم الآن**    | زر + رسالة اختيارية                                              | Modal في التفاصيل، استدعاء apply ثم إغلاق/تنبيه                                    | ✅ منفذ |
| **تقدماتي**      | قائمة التقديمات التي أرسلتها                                     | `KawaderMyApplicationsScreen` — حالة كل تقديم، الانتقال لتفاصيل العرض              | ✅ منفذ |
| **معرضي**        | إدارة معرض أعمالي (إضافة، حذف)                                   | `KawaderPortfolioScreen` — قائمة، إضافة (صورة + وصف)، حذف                          | ✅ منفذ |
| **معرض المعلن**  | عرض معرض صاحب العرض في التفاصيل                                  | في `KawaderDetailsScreen` — getPortfolioByUser(ownerId)، شريط أفقي                 | ✅ منفذ |
| **التقييمات**    | عرض متوسط + قائمة مراجعات، إضافة تقييم                           | في `KawaderDetailsScreen` — getReviewsByUser، زر "أضف تقييماً"، Modal نجوم + تعليق | ✅ منفذ |
| **المحادثة**     | تواصل مع المعلن                                                  | kawader-chat (قائمة محادثات، شاشة دردشة)                                           | ✅ منفذ |
| **البطاقة**      | عرض نوع الوظيفة، موقع، راتب                                      | `KawaderCard` — jobType، location، salary ?? budget                                | ✅ منفذ |

### شاشات كوادر في التطبيق

- `KawaderListScreen.tsx` — قائمة العروض (تبويبات + بحث)
- `KawaderDetailsScreen.tsx` — تفاصيل عرض (تقدم الآن، تقديمات للمالك، معرض، تقييمات)
- `KawaderCreateScreen.tsx` — إنشاء عرض
- `KawaderEditScreen.tsx` — تعديل عرض
- `KawaderMyApplicationsScreen.tsx` — تقدماتي
- `KawaderPortfolioScreen.tsx` — معرضي
- محادثات الكوادر: `KawaderChatListScreen`، `KawaderChatScreen`

---

## 5. المقارنة حسب الويب (bthwani-web)

| الميزة              | المتطلب                                             | التنفيذ                                                                                       | الحالة  |
| ------------------- | --------------------------------------------------- | --------------------------------------------------------------------------------------------- | ------- |
| **قائمة العروض**    | تصفح، فلاتر، بحث، عروضي                             | `KawaderList` — تبويبان (الكل / عروضي)، حقل بحث (Enter)، useKawaderList(mode, filters)        | ✅ منفذ |
| **تفاصيل عرض**      | عرض كامل، نوع، موقع، راتب، تقدم الآن، معرض، تقييمات | `KawaderDetails` — تفاصيل، زر تقدم الآن، تقديمات للمالك، معرض المعلن، التقييمات + إضافة تقييم | ✅ منفذ |
| **إنشاء/تعديل عرض** | نموذج كامل مع نوع العرض والوظيفة والموقع والراتب    | `KawaderForm` — offerType، jobType، location، salary/ميزانية                                  | ✅ منفذ |
| **تقدم الآن**       | زر + نافذة رسالة                                    | Dialog في التفاصيل + applyToKawader                                                           | ✅ منفذ |
| **معرض المعلن**     | عرض في صفحة التفاصيل                                | getPortfolioByUser في التفاصيل، شريط أفقي                                                     | ✅ منفذ |
| **التقييمات**       | متوسط + قائمة + إضافة تقييم                         | getReviewsByUser، زر أضف تقييماً، Dialog نجوم + تعليق                                         | ✅ منفذ |
| **البطاقة**         | عرض نوع الوظيفة، موقع، راتب                         | `KawaderCard` — jobType، location، salary ?? budget                                           | ✅ منفذ |

### المكونات في bthwani-web

- `KawaderList.tsx` — قائمة العروض (تبويبات + بحث)
- `KawaderCard.tsx` — بطاقة عرض
- `KawaderDetails.tsx` — تفاصيل عرض (تقدم الآن، تقديمات، معرض، تقييمات)
- `KawaderForm.tsx` — نموذج إنشاء/تعديل
- `KawaderFilters.tsx` — فلاتر (قابل ربطها بالبحث المتقدم)
- `api.ts` — getKawaderList، getMyKawader، searchKawader، apply، portfolio، reviews
- `useKawaderList.ts` — دعم all / my / search مع فلاتر

---

## 6. ملخص تنفيذ الميزات

### 6.1 ملخص حسب النوع

| النوع                   | الميزات المطلوبة (V3)                                             | المنفذة                                                 | النسبة |
| ----------------------- | ----------------------------------------------------------------- | ------------------------------------------------------- | ------ |
| **أساسي (Core)**        | نشر وظيفة/خدمة، ملف مستقل (عروض+معرض+تقييمات)، تقييمات، تقدم الآن | ✅ الكل (ملف المستقل عبر تفاصيل العرض + معرض + تقييمات) | 100%   |
| **متقدم (Advanced)**    | معرض Portfolio، فئات/نطاق عمل، تواصل ومحادثة                      | ✅ معرض، نطاق عمل، محادثة                               | 100%   |
| **متقدم (مرحلة لاحقة)** | تقويم الحجوزات، Slots                                             | ❌                                                      | 0%     |
| **ذكي (Smart)**         | اقتراح سيرة، تطابق وظائف، تنبيهات، شارة "قريب"                    | ❌                                                      | 0%     |

### 6.2 الميزات المكتملة

1. **نشر عرض وظيفة/خدمة** — عنوان، وصف، نطاق، نوع عرض (وظيفة/خدمة)، نوع وظيفة (دوام كامل/جزئي/عن بُعد)، موقع، راتب/ميزانية، مهارات، تواصل.
2. **عروضي وبحث** — GET my، GET search مع q وفلترة.
3. **تقدم الآن** — POST apply، عرض التقديمات للمالك، قبول/رفض، تقديماتي.
4. **معرض الأعمال** — رفع صورة، إضافة عنصر (mediaIds، caption)، معرضي، معرض مستخدم، حذف عنصر.
5. **التقييمات** — إنشاء مراجعة (rating، comment)، مراجعات مستخدم مع متوسط وعدد.
6. **المحادثة** — بدء محادثة من تفاصيل العرض (kawader-chat).
7. **الباك اند** — كل الـ endpoints المذكورة أعلاه مع صلاحيات (مالك، مصادقة).
8. **التطبيق والويب** — قوائم، تفاصيل، نماذج، تقدم الآن، معرض، تقييمات.

### 6.3 خريطة التطابق مع المتطلبات

```
متطلبات V3 – Jobs & Services              ←→          خدمة كوادر المنفذة
─────────────────────────────────────────────────────────────────────────
job-posting-service                      ←→          Kawader (offerType: job) + Create/Update
service-offer-service                    ←→          Kawader (offerType: service)
portfolio-service                        ←→          KawaderPortfolio + KawaderMedia + upload
application-service                      ←→          KawaderApplication + apply + applications/my + status
review-service                           ←→          KawaderReview + create + getReviewsByUser
booking-calendar-service                 ←→          غير منفذ (مرحلة لاحقة)
/jobs/post، /services/create              ←→          POST /kawader (مع offerType)
/jobs/apply                              ←→          POST /kawader/:id/apply
/freelancer/:id (profile)                ←→          عرض عروض المعلن + معرضه + تقييماته في تفاصيل العرض
```

---

## هل كل المذكور أعلاه منفذ؟

| الجانب                            | الحالة              | ملاحظة                                                                                                                                                                                                                                                      |
| --------------------------------- | ------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **الباك اند (backend-nest)**      | ✅ **منفذ بالكامل** | جميع الـ endpoints (my، search، apply، applications، portfolio، review، upload)، الـ entities، والصلاحيات موجودة وتعمل.                                                                                                                                     |
| **تطبيق المستخدم (app-user)**     | ✅ **منفذ بالكامل** | كل الشاشات والميزات المذكورة: قائمة (تبويبات + بحث)، تفاصيل (تقدم الآن، تقديمات للمالك، معرض، تقييمات)، إنشاء/تعديل (offerType، jobType، location، salary)، تقدماتي، معرضي، محادثة.                                                                         |
| **الموقع (bthwani-web)**          | ✅ **منفذ بالكامل** | قائمة (الكل/عروضي + بحث)، تفاصيل (تقدم الآن، معرض، تقييمات)، نموذج إنشاء/تعديل بكل الحقول، API وhooks.                                                                                                                                                      |
| **لوحة التحكم (admin-dashboard)** | ⚠️ **جزئي**         | قائمة عروض الكوادر، تفاصيل عرض، تحديث الحالة، حذف، وإحصائيات **موجودة**. لكن **غير منفذ بعد:** فلاتر offerType / jobType / location في القائمة، أعمدة النوع والموقع في الجدول، وعرض قائمة التقديمات على العرض في صفحة التفاصيل (هذه من المرحلة 8 في الخطة). |

**خلاصة:** كل ما ذُكر في المستند من ناحية **الباك اند، التطبيق، والويب** منفذ. في **لوحة التحكم** الأساس (قائمة، تفاصيل، حالة، إحصائيات) منفذ، أما تحسينات المرحلة 8 (فلاتر النوع/الموقع وعرض التقديمات) فلم تُنفذ بعد.

---

## الخلاصة

تم تنفيذ **خدمة كوادر** بشكل يغطي المتطلبات الأساسية والمتقدمة لـ **V3 – Jobs & Services** في مستند التسليم، عدا تقويم الحجوزات والميزات الذكية:

- **الباك اند:** نشر عرض (وظيفة/خدمة)، عروضي، بحث، تقديم، معرض أعمال (مع رفع صورة)، تقييمات، مع تحقق صلاحيات المالك والمصادقة.
- **التطبيق (app-user):** قوائم (الكل، عروضي، تقدماتي، معرضي)، تفاصيل مع تقدم الآن وتقديمات للمالك ومعرض وتقييمات، إنشاء/تعديل عرض بكل الحقول، شاشة معرضي، محادثات كوادر.
- **الويب (bthwani-web):** قائمة مع تبويبي الكل/عروضي وبحث، تفاصيل مع تقدم الآن ومعرض وتقييمات، نموذج إنشاء/تعديل مع offerType، jobType، location، salary.
- **لوحة التحكم:** إدارة عروض الكوادر وإحصائيات؛ يمكن توسيعها بعرض التقديمات وفلاتر النوع والموقع حسب الخطة.

**غير مشمول حالياً:** تقويم الحجوزات (Slots)، اقتراح السيرة، تطابق الوظائف، تنبيهات المهارات، شارة "مستقل قريب". صفحة ملف مستقل مستقلة (Freelancer Profile) يمكن بناؤها لاحقاً تجميعاً لعروض المستخدم + معرضه + تقييماته تحت مسار واحد.

---

_آخر تحديث: وفق مقارنة خدمة كوادر المنفذة مع مواصفات V3 – Jobs & Services في وثيقة التسليم وخطة الإكمال (PLAN_KAWADER_SERVICE_COMPLETION.md)._
